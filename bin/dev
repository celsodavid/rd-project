#!/bin/bash
ARG=$1
ARG2=$2

if test $ARG2; then
    if [ $ARG2 = "magento" ]; then
      FILE="docker-compose-magento.yml";
    elif [ $ARG2 = "ms" ]; then
      FILE="docker-compose-ms.yml";
    fi
  else
    FILE="docker-compose-general.yml";
  fi

USER=whoami | awk '{print $1}'

if [ $USER = "root" ]; then
    echo "NÃ£o utilize sudo";
    exit
fi

export USERID=${UID}
export GROUPID=${GID}

if ! test $ARG; then
   sudo chmod 777 -R /var/run/docker.sock; docker-compose stop; docker-compose up -d; docker-compose ps;
   exit
fi


if [ $ARG = "start" ]; then
  docker-compose -f $FILE up -d; docker-compose ps;
  exit;
fi

if [ $ARG = "stop" ]; then
    docker-compose -f $FILE stop;
    exit;
fi

if [ $ARG = "restart" ]; then
    docker-compose -f $FILE stop; docker-compose -f $FILE up -d; docker-compose ps;
    exit;
fi

if [ $ARG = "status" ]; then
    docker-compose ps;
    exit;
fi

if [ $ARG = "build" ]; then
    bin/dev -f $FILE stop; docker-compose -f $FILE build;
    bin/dev start $ARG2;
    exit;
fi
